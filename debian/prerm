#!/bin/bash
# prerm script for jolicloud-tweaks
#
# see: dh_installdeb(1)

set -e

# Application directories
app_dir="/usr/share/jolicloud-tweaks"
save_dir="$app_dir/save"

# Remove fix for evolution when computer is put on AC
if [ -a /etc/acpi/mailbtn.sh ]; then
	chmod +x /etc/acpi/mailbtn.sh
fi

# Remove fix for the shutdown problem
if [ -a /etc/default/halt ]; then
	sed -i 's/^rmmod snd-hda-intel #Automatic fix by jolicloud-tweaks$//' /etc/default/halt
fi

# Restore the GDM theme
if [ -a /etc/gdm/gdm.conf-custom ]; then
	$app_dir/restore-conf /etc/gdm/gdm.conf-custom
fi

# Restore Firefox settings
if [ -a /etc/firefox-3.0/pref/ubufox.js ]; then
	newFile=`cat /etc/firefox-3.0/pref/ubufox.js | grep -v " //Added by jolicloud-tweaks$"`
	echo "$newFile" > /etc/firefox-3.0/pref/ubufox.js
fi

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
